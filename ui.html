<style>
  body {
    background: #222;
    margin: 0;
    padding: 20px;
    font-family: serif;
    font-size: 14px;
    color: #fff;
  }
  .sf {
    font-family: 'SF Pro Display', 'SF Compact Display';
    font-size: 48px;
  }
</style>
<h2>Rectangle Creator</h2>
<p>Count: <input id="count" value="5"></p>
<button id="create">Create</button>
<button id="cancel">Cancel</button>

<div class="sf">SanFrancisco Font ô€†¶</div>
<script>
var csvFileName = 'SFSymbols_20191028.csv'

document.getElementById('create').onclick = () => {
  const textbox = document.getElementById('count');
  const count = parseInt(textbox.value, 10);
  parent.postMessage({ pluginMessage: { type: 'create-rectangles', count } }, '*')
}

document.getElementById('cancel').onclick = () => {
  parent.postMessage({ pluginMessage: { type: 'cancel' } }, '*')
}

getCSV(csvFileName)

function getCSV(file){
  var req = new XMLHttpRequest()
  console.log(file)
  req.open("get", file, true)
  req.send(null)

  req.onload = function(){
    return csv2json(req.responseText)
  }
}

function csv2json(csv){
  var jsonArray = []
  var csvArray = csv.split('\n')     
  var items = csvArray[0].split(',')
 
  for (var i = 1; i < csvArray.length - 1; i++) {
    var a_line = new Object();
    var csvArrayD = csvArray[i].split(',');
    for (var j = 0; j < items.length; j++) {
      a_line[items[j]] = csvArrayD[j];
    }
    jsonArray.push(a_line);
  }
  console.debug(jsonArray);
  return jsonArray;
}

</script>
